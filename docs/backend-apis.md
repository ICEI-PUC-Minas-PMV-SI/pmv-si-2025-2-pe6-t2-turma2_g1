# APIs e Web Services

O projeto consiste no desenvolvimento de uma API escal√°vel para um e-commerce B2B de itens eletr√¥nicos (notebooks, mouses, fones, mem√≥rias RAM, etc.). Constru√≠da em Node.js com MongoDB, a API disponibiliza funcionalidades como cadastro de usu√°rios, gerenciamento de produtos, categorias, pedidos e autentica√ß√£o. Os endpoints s√£o testados e validados utilizando o Postman.



## Objetivos da API

A API do nosso E-commerce foi desenvolvida para fornecer uma interface simples, segura e escal√°vel para gerenciamento de produtos, categorias, pedidos e usu√°rios. Sua finalidade √©:
- Permitir a integra√ß√£o entre o back-end e o front-end da aplica√ß√£o de e-commerce.  
- Oferecer endpoints REST para opera√ß√µes de CRUD (criar, ler, atualizar e deletar) sobre os principais recursos do sistema.  
- Garantir seguran√ßa na autentica√ß√£o e autoriza√ß√£o de usu√°rios por meio de **JWT (JSON Web Token)**. 

### Recursos principais expostos pela API
As rotas de **produtos** permitem gerenciar os itens dispon√≠veis para venda no e-commerce.  
Todas as opera√ß√µes de cria√ß√£o, atualiza√ß√£o e exclus√£o exigem **autentica√ß√£o via JWT** (usu√°rio administrador).

As rotas de **categorias** permitem organizar os produtos em grupos l√≥gicos.  
Todas as opera√ß√µes de cria√ß√£o, atualiza√ß√£o e exclus√£o exigem **autentica√ß√£o via JWT** (usu√°rio administrador).

As rotas de **pedidos** permitem criar, listar, atualizar e excluir pedidos de clientes, al√©m de obter m√©tricas como vendas totais e contagem de pedidos.  
Todas as opera√ß√µes exigem **autentica√ß√£o via JWT** (usu√°rio autenticado), sendo que algumas opera√ß√µes espec√≠ficas (como listar todos ou deletar pedidos) devem ser restritas a administradores.

As rotas de **usu√°rios** permitem o gerenciamento de clientes e administradores do sistema, al√©m de oferecer endpoints de autentica√ß√£o (login e registro).  
As rotas de administra√ß√£o (listar, criar, atualizar e deletar usu√°rios) exigem **autentica√ß√£o via JWT** e privil√©gios de administrador.


## Modelagem da Aplica√ß√£o

A aplica√ß√£o utiliza MongoDB como banco de dados, com modelagem baseada em documentos. As principais entidades s√£o: Usu√°rio, Categoria, Produto, ItemPedido e Pedido. Cada entidade √© representada por um Schema do Mongoose e possui relacionamentos entre si.

### Usu√°rio

Representa os clientes e administradores da plataforma.

**Campos:**  
- `nome: String (obrigat√≥rio)`  
- `email: String (obrigat√≥rio)`  
- `Hashsenha: String (obrigat√≥rio, senha criptografada)`  
- `telefone: String (obrigat√≥rio)`  
- `isAdmin: Boolean (padr√£o: false)`  
- `rua: String`  
- `apartamento: String`  
- `cep: String`  
- `cidade: String`  
- `estado: String`  



###  Categoria

Organiza os produtos em grupos tem√°ticos.

**Campos:**  
- `nome: String (obrigat√≥rio)`  
- `icone: String`  
- `cor: String`  



### Produto

Representa um item dispon√≠vel para compra.

**Campos:**  
- `nome: String (obrigat√≥rio)`  
- `descricao: String (obrigat√≥rio)`  
- `descricaoDetalhada: String (padr√£o: "")`  
- `imagem: String (padr√£o: "")`  
- `marca: String (padr√£o: "")`  
- `preco: Number (padr√£o: 0)`  
- `categoria: ObjectId ‚Üí Categoria (obrigat√≥rio)`  
- `contagemEstoque: Number (obrigat√≥rio, min: 0, max: 255)`  
- `emDestaque: Boolean (padr√£o: false)`  



### Pedido

Representa a compra realizada por um usu√°rio.

**Campos:**  
- `itensPedido: [ObjectId ‚Üí ItemPedido] (obrigat√≥rio)`  
- `enderecoEntrega1: String (obrigat√≥rio)`  
- `enderecoEntrega2: String`  
- `cidade: String (obrigat√≥rio)`  
- `cep: String (obrigat√≥rio)`  
- `estado: String (obrigat√≥rio)`  
- `telefone: String (obrigat√≥rio)`  
- `status: String (obrigat√≥rio, padr√£o: "Pendente")`  
- `precoTotal: Number`  
- `usuario: ObjectId ‚Üí Usuario (obrigat√≥rio)`  
- `dataPedido: Date (padr√£o: Date.now)`  



### üîó Relacionamentos  

- Um **Produto** pertence a **uma Categoria**.  
- Um **Pedido** √© feito por **um Usu√°rio**.  
- Um **Pedido** cont√©m **v√°rios ItensPedido**.  
- Cada **ItemPedido** referencia **um Produto**.  



## Tecnologias Utilizadas

A API foi desenvolvida com base em tecnologias modernas que permitem escalabilidade, seguran√ßa e facilidade de manuten√ß√£o.  
A tabela abaixo apresenta as principais ferramentas utilizadas no projeto:

| Categoria       | Tecnologia | Vers√£o     | Por que foi escolhida? |
|-----------------|------------|------------|-------------------------|
| **Backend**     | Node.js    | 20.x       | Plataforma leve, r√°pida e amplamente utilizada para aplica√ß√µes escal√°veis em tempo real. |
| **Framework**   | Express.js | 4.x        | Framework minimalista para Node.js que simplifica a cria√ß√£o de APIs RESTful. |
| **Banco de Dados** | MongoDB | 6.x        | Banco de dados NoSQL orientado a documentos, flex√≠vel e ideal para aplica√ß√µes que lidam com dados din√¢micos. |
| **Autentica√ß√£o**| JWT (JSON Web Token) | - | M√©todo seguro e simples para autentica√ß√£o e autoriza√ß√£o de usu√°rios em APIs. |
| **Testes**      | Postman    | √öltima vers√£o | Ferramenta pr√°tica para testar endpoints, validar requisi√ß√µes e documentar chamadas da API. |
| **Cont√™iner**      | Docker    | √öltima vers√£o | Ferramenta utlizada para empacotar tudo que o c√≥digo precisa para rodar (c√≥digo, bibliotecas, configura√ß√µes). |

## API Endpoints

Endpoints da API (localhost:3000) no Swagger, focando no CRUD de usu√°rios. Os exemplos demonstram requisi√ß√µes e respostas para opera√ß√µes como busca (GET), cria√ß√£o (POST), atualiza√ß√£o (PUT) e exclus√£o (DELETE), validando o funcionamento integrado do sistema.

### Capturas de tela do Swagger em execu√ß√£o local (porta 3000) - Testes do CRUD de produtos
- M√©todo POST(Cria√ß√£o de um produto)


![Criar um novo produto POST](../docs/postprodutoswagger.png)


- M√©todo: GET (Listar produtos com op√ß√£o de filtrar por categorias)

![ListarprodutosGET](../docs/getprodutosswagger.png)


- M√©todo: PUT (Atualiza um produto existente)

![AtualizaprodutoPUT](../docs/putprodutosswagger.png)

- M√©todo: DELETE


![DeletarprodutoDELETE](../docs/)


## Considera√ß√µes de Seguran√ßa

A seguran√ßa √© um aspecto cr√≠tico para qualquer API web, especialmente em aplica√ß√µes de e-commerce que lidam com dados sens√≠veis. A seguir, est√£o as principais medidas adotadas nesta API:

- A API utiliza **JWT (JSON Web Token)** para autentica√ß√£o.
- Usu√°rios devem fornecer um token v√°lido para acessar rotas protegidas.
- Tokens possuem **tempo de expira√ß√£o de 24 horas**, reduzindo o risco de uso indevido em caso de vazamento.
- Senhas s√£o **armazenadas criptografadas** usando **bcrypt**, garantindo que a senha real nunca seja salva no banco de dados.
- Boas pr√°ticas de configura√ß√£o, como uso de vari√°veis de ambiente para chaves sens√≠veis..

## Implanta√ß√£o

 Passos necess√°rios para implantar a aplica√ß√£o em um ambiente de produ√ß√£o.

### Requisitos de Hardware e Software

### Hardware
- CPU: 2 cores ou mais
- Mem√≥ria RAM: 4GB ou mais
- Armazenamento: 20GB ou mais
- Conectividade de rede est√°vel

### Software
- Node.js (vers√£o 20.x)
- MongoDB (vers√£o 6.x ou compat√≠vel)
- Git
- NPM 
- Servidor web (opcional: Nginx ou Apache para proxy reverso)
- Docker/Docker Desktop
- Sistema operacional:  Windows ou Linux


### Configura√ß√£o do Ambiente

1. **Clonar o reposit√≥rio:**
   ```bash
   git clone https://github.com/ICEI-PUC-Minas-PMV-SI/pmv-si-2025-2-pe6-t2-turma2_g1.git 
   
   cd pmv-si-2025-2-pe6-t2-turma2_g1
   
   Conecte seu reposit√≥rio Git;
    ```

2. **Instale o Docker/Docker Desktop:**
    
    Windows: https://docs.docker.com/desktop/setup/install/windows-install/
    
    Linux: https://docs.docker.com/engine/install/


3. **Inicie a API usando o Docker**

    Entre no diret√≥rio do projeto e execute o seguinte comando:
    
    ```bash
   docker compose up --build
   ```

   Caso queira parar o container, execute o comando:

   ```bash
   docker compose down
   ```

4. **O cont√™iner estar√° pronto para receber requisi√ß√µes na porta 3000**

5. **Testes em Produ√ß√£o:**

- Verifique se a API est√° acess√≠vel no endere√ßo configurado 
- Teste endpoints principais com Postman ou ferramentas similares.
- Certifique-se de que a Autentica√ß√£o JWT funciona corretamente.
- Opera√ß√µes CRUD est√£o funcionando em produtos, pedidos, categorias e usu√°rios.


**[Escolha da Plataforma de Hospedagem]** A definir pelo grupo

## Testes

1. **Valida√ß√£o de dados:** 
Objetivo: Garantir que os dados enviados aos endpoints estejam no formato e tipo corretos.

Resultados esperados:

Requisi√ß√µes com dados v√°lidos (ex: id de produto correto, quantidade positiva) devem ser processadas com sucesso (ex: HTTP 200 ou 201). E Requisi√ß√µes com dados inv√°lidos (ex: id inexistente, quantidade negativa, campos obrigat√≥rios ausentes) devem retornar erros apropriados (ex: HTTP 500 ou 401) com mensagens claras
![validacaodedadosprodutoGET](../docs/validacaodedadosprodutoGET.png)
![validacaodedadoserror500](../docs/validacaodedadoserror500.png)

2. **Cadastro de um produto:** 
Resultados esperados:

Um novo produto com todos os campos obrigat√≥rios preenchidos deve ser salvo no banco e retornar HTTP 200 OK
![produtosalvocomsucessoPOST200](../docs/produtosalvocomsucessoPOST200.png)

O banco deve refletir a inser√ß√£o (verific√°vel via MongoDB)
![produtosalvonobanco](../docs/produtosalvonobanco.png)

3. **Requisi√ß√µes com dados inv√°lidos:** 
Requisi√ß√µes com dados faltantes ou inv√°lidos devem ser rejeitadas
![requiseicaorejeitadaPOST](../docs/requiseicaorejeitadaPOST.png)

4. **Autentica√ß√£o e autoriza√ß√£o** 
Objetivo: Garantir seguran√ßa de acesso aos endpoints sens√≠veis.
![autoriza√ß√£oPOSTpedidos](../docs/autoriza√ß√£oPOSTpedidos.png)

# Refer√™ncias

Inclua todas as refer√™ncias (livros, artigos, sites, etc) utilizados no desenvolvimento do trabalho.

- [Learn REST APIs](https://rapidapi.com/learn/rest#what-is-an-api)
- [Documenta√ß√£o oficial do Node.js](https://nodejs.org/en/docs)
- [Guia Express.js](https://expressjs.com/pt-br/)
- [Artigo sobre JWT Authentication](https://jwt.io/introduction/)
- [Microfundamento APIs e Web Services](https://pucminas.instructure.com/courses/155663)
- [Microfundamento: Desenvolvimento Web Back-End](https://pucminas.instructure.com/courses/149505)
- [E-Commerce API with Node JS](https://www.youtube.com/watch?v=hPv9QwvliEM&list=PLzb46hGUzitBp584kLyn6l3i6yC-rXlmN)
 

# Planejamento

##  Quadro de tarefas

> Apresente a divis√£o de tarefas entre os membros do grupo e o acompanhamento da execu√ß√£o, conforme o exemplo abaixo.

### Backend APIs

Atualizado em: 04/10/2025

| Respons√°vel   | Tarefa/Requisito | Iniciado em    | Prazo      | Status | Terminado em    |
| :----         |    :----         |      :----:    | :----:     | :----: | :----:          |
| Vitoria         | Estrutura inicial das APIs | 04/09/2025     | 05/10/2025 | ‚úîÔ∏è    | 16/09/2025     |
| Vitoria e Helberth        | API Produdo    | 04/09/2025     | 05/10/2025 | ‚úîÔ∏è    |   29/09/2025              |
| Vitoria        | API Categoria  | 04/09/2025     | 05/10/2025 | ‚úîÔ∏è     |  16/09/2025               |
| Nathan e Ian       | API Usuario e JWT  |    23/09/2025        | 05/10/2025 |  ‚úîÔ∏è  |   04/10/2025     |
| Sophia e Rafael        | API Pedidos  |    23/09/2025        | 05/10/2025 | ‚úîÔ∏è   |   04/10/2025    |
| Nathan       | Ambiente Docker  |    23/09/2025        | 05/10/2025 |  ‚úîÔ∏è  |   29/09/2025     |

#### Documenta√ß√£o

Atualizado em: 04/10/2025

| Respons√°vel   | Tarefa/Requisito | Iniciado em    | Prazo      | Status | Terminado em    |
| :----         |    :----         |      :----:    | :----:     | :----: | :----:          |
| Vitoria        | APIS e Web   | 27/09/2025     | 27/09/2025 | ‚úîÔ∏è    | 27/09/2025      |
| Rafael        | Objetivos    | 04/10/2025     | 05/10/2025 | ‚úîÔ∏è     |     04/10/2025            |
| Helberth        | Modelagem da aplica√ß√£o    | 04/10/2025     | 05/10/2025 | ‚úîÔ∏è     |     04/10/2025            |
| Sophia        | Tecnologias utilizadas    | 04/10/2025     | 05/10/2025 | ‚úîÔ∏è     |     04/10/2025            |
| Vitoria        | APIs e endpoints    | 04/10/2025     | 05/10/2025 | ‚úîÔ∏è     |     04/10/2025            |
| Sophia        | Considera√ß√µes de seguran√ßa    | 04/10/2025     | 05/10/2025 | ‚úîÔ∏è     |     04/10/2025            |
| Nathan        | Implanta√ß√£o    | 04/10/2025     | 05/10/2025 | ‚úîÔ∏è     |     04/10/2025            |
| Ian        | Testes    | 04/10/2025     | 05/10/2025 | ‚úîÔ∏è     |     04/10/2025            |

Legenda:
- ‚úîÔ∏è: terminado
- üìù: em execu√ß√£o
- ‚åõ: atrasado
- ‚ùå: n√£o iniciado

